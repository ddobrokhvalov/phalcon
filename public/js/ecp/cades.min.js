function PromiseHelper(){}function ToArrayHelper(){}function Cades(){var e=new Promise(function(e,t){window.cadesplugin.then(function(){e()}).then(null,function(e){t(e)})})
this.then=function(){return e.then.apply(e,arguments)}}function Store(e){this._store=e,this.CAPICOM_MY_STORE="My",this.CAPICOM_CURRENT_USER_STORE=2,this.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED=2,this.CAPICOM_STORE_OPEN_READ_ONLY=0}function SignedData(e){this._signedData=e,this.CADESCOM_STRING_TO_UCS2LE=0,this.CADESCOM_BASE64_TO_BINARY=1,this.CAPICOM_ENCODE_BASE64=0,this.CADESCOM_CADES_BES=1}function Signer(e){this._signer=e}function CPAttribute(e){this._attribute=e,this.CAPICOM_AUTHENTICATED_ATTRIBUTE_SIGNING_TIME=0}function Certificates(e){this._certificates=e,this.CAPICOM_CERTIFICATE_FIND_TIME_VALID=9,this.CAPICOM_CERTIFICATE_FIND_SHA1_HASH=0,this.CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME=1}function Certificate(e){this._certificate=e,this.CAPICOM_ENCODE_BASE64=0,this.CADESCOM_CADES_BES=1,this.CAPICOM_CERT_INFO_SUBJECT_SIMPLE_NAME=0,this.CAPICOM_CERT_INFO_ISSUER_SIMPLE_NAME=1,this.CAPICOM_CERT_INFO_SUBJECT_EMAIL_NAME=2,this.CAPICOM_CERT_INFO_ISSUER_EMAIL_NAME=3,this.CAPICOM_CERT_INFO_SUBJECT_UPN=4,this.CAPICOM_CERT_INFO_ISSUER_UPN=5,this.CAPICOM_CERT_INFO_SUBJECT_DNS_NAME=6,this.CAPICOM_CERT_INFO_ISSUER_DNS_NAME=7}function CertificateStatus(e){this._certificateStatus=e}function ExtendedKeyUsage(e){this._extendedKeyUsage=e}function EKUs(e){this._ekus=e}function EKU(e){this._eku=e}function KeyUsage(e){this._keyUsage=e}function PublicKey(e){this._publicKey=e}function OID(e){this._oid=e}function EncodedData(e){this._encodedData=e}function PrivateKey(e){this._privateKey=e}function BasicConstraints(e){this._basicConstraints=e}!window.addEventListener&&function(e,t,n,i,o,r,s){e[i]=t[i]=n[i]=function(e,t){var n=this
s.unshift([n,e,t,function(e){e.currentTarget=n,e.preventDefault=function(){e.returnValue=!1},e.stopPropagation=function(){e.cancelBubble=!0},e.target=e.srcElement||n,t.call(n,e)}]),this.attachEvent("on"+e,s[0][3])},e[o]=t[o]=n[o]=function(e,t){for(var n,i=0;n=s[i];++i)if(n[0]==this&&n[1]==e&&n[2]==t)return this.detachEvent("on"+e,s.splice(i,1)[0][3])},e[r]=t[r]=n[r]=function(e){return this.fireEvent("on"+e.type,e)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),function(e,t){function n(e){var n=t[e]
t[e]=function(e){return o(n(e))}}function i(t,n,i){return(i=this).attachEvent("on"+t,function(t){var t=t||e.event
t.preventDefault=t.preventDefault||function(){t.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){t.cancelBubble=!0},n.call(i,t)})}function o(e,t){if(t=e.length)for(;t--;)e[t].addEventListener=i
else e.addEventListener=i
return e}e.addEventListener||(o([t,e]),"Element"in e?e.Element.prototype.addEventListener=i:(t.attachEvent("onreadystatechange",function(){o(t.all)}),n("getElementsByTagName"),n("getElementById"),n("createElement"),o(t.all)))}(window,document),function(){function cpcsp_console_log(e,t){if(e<=cadesplugin.current_log_level)return e==cadesplugin.LOG_LEVEL_DEBUG&&console.log("DEBUG: %s",t),e==cadesplugin.LOG_LEVEL_INFO&&console.info("INFO: %s",t),void(e==cadesplugin.LOG_LEVEL_ERROR&&console.error("ERROR: %s",t))}function set_log_level(e){return e!=cadesplugin.LOG_LEVEL_DEBUG&&e!=cadesplugin.LOG_LEVEL_INFO&&e!=cadesplugin.LOG_LEVEL_ERROR?void cpcsp_console_log(cadesplugin.LOG_LEVEL_ERROR,"cadesplugin_api.js: Incorrect log_level: "+e):(cadesplugin.current_log_level=e,cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_DEBUG&&cpcsp_console_log(cadesplugin.LOG_LEVEL_INFO,"cadesplugin_api.js: log_level = DEBUG"),cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_INFO&&cpcsp_console_log(cadesplugin.LOG_LEVEL_INFO,"cadesplugin_api.js: log_level = INFO"),cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_ERROR&&cpcsp_console_log(cadesplugin.LOG_LEVEL_INFO,"cadesplugin_api.js: log_level = ERROR"),void(isChromiumBased()&&(cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_DEBUG&&window.postMessage("set_log_level=debug","*"),cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_INFO&&window.postMessage("set_log_level=info","*"),cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_ERROR&&window.postMessage("set_log_level=error","*"))))}function set_constantValues(){cadesplugin.CAPICOM_LOCAL_MACHINE_STORE=1,cadesplugin.CAPICOM_CURRENT_USER_STORE=2,cadesplugin.CAPICOM_MY_STORE="My",cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED=2,cadesplugin.CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME=1,cadesplugin.CADESCOM_XML_SIGNATURE_TYPE_ENVELOPED=0,cadesplugin.CADESCOM_XML_SIGNATURE_TYPE_ENVELOPING=1,cadesplugin.CADESCOM_XML_SIGNATURE_TYPE_TEMPLATE=2,cadesplugin.XmlDsigGost3410UrlObsolete="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",cadesplugin.XmlDsigGost3411UrlObsolete="http://www.w3.org/2001/04/xmldsig-more#gostr3411",cadesplugin.XmlDsigGost3410Url="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr34102001-gostr3411",cadesplugin.XmlDsigGost3411Url="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr3411",cadesplugin.CADESCOM_CADES_DEFAULT=0,cadesplugin.CADESCOM_CADES_BES=1,cadesplugin.CADESCOM_CADES_T=5,cadesplugin.CADESCOM_CADES_X_LONG_TYPE_1=93,cadesplugin.CADESCOM_ENCODE_BASE64=0,cadesplugin.CADESCOM_ENCODE_BINARY=1,cadesplugin.CADESCOM_ENCODE_ANY=-1,cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_CHAIN_EXCEPT_ROOT=0,cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_WHOLE_CHAIN=1,cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY=2,cadesplugin.CAPICOM_CERT_INFO_SUBJECT_SIMPLE_NAME=0,cadesplugin.CAPICOM_CERT_INFO_ISSUER_SIMPLE_NAME=1,cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH=0,cadesplugin.CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME=1,cadesplugin.CAPICOM_CERTIFICATE_FIND_ISSUER_NAME=2,cadesplugin.CAPICOM_CERTIFICATE_FIND_ROOT_NAME=3,cadesplugin.CAPICOM_CERTIFICATE_FIND_TEMPLATE_NAME=4,cadesplugin.CAPICOM_CERTIFICATE_FIND_EXTENSION=5,cadesplugin.CAPICOM_CERTIFICATE_FIND_EXTENDED_PROPERTY=6,cadesplugin.CAPICOM_CERTIFICATE_FIND_APPLICATION_POLICY=7,cadesplugin.CAPICOM_CERTIFICATE_FIND_CERTIFICATE_POLICY=8,cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_VALID=9,cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_NOT_YET_VALID=10,cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_EXPIRED=11,cadesplugin.CAPICOM_CERTIFICATE_FIND_KEY_USAGE=12,cadesplugin.CAPICOM_DIGITAL_SIGNATURE_KEY_USAGE=128,cadesplugin.CAPICOM_PROPID_ENHKEY_USAGE=9,cadesplugin.CAPICOM_OID_OTHER=0,cadesplugin.CAPICOM_OID_KEY_USAGE_EXTENSION=10,cadesplugin.CAPICOM_EKU_CLIENT_AUTH=2,cadesplugin.CAPICOM_EKU_SMARTCARD_LOGON=5,cadesplugin.CAPICOM_EKU_OTHER=0,cadesplugin.CAPICOM_AUTHENTICATED_ATTRIBUTE_SIGNING_TIME=0,cadesplugin.CADESCOM_AUTHENTICATED_ATTRIBUTE_DOCUMENT_NAME=1,cadesplugin.CADESCOM_AUTHENTICATED_ATTRIBUTE_DOCUMENT_DESCRIPTION=2,cadesplugin.CADESCOM_ATTRIBUTE_OTHER=-1,cadesplugin.CADESCOM_STRING_TO_UCS2LE=0,cadesplugin.CADESCOM_BASE64_TO_BINARY=1,cadesplugin.CADESCOM_DISPLAY_DATA_NONE=0,cadesplugin.CADESCOM_DISPLAY_DATA_CONTENT=1,cadesplugin.CADESCOM_DISPLAY_DATA_ATTRIBUTE=2,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_RC2=0,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_RC4=1,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_DES=2,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_3DES=3,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_AES=4,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_GOST_28147_89=25,cadesplugin.CADESCOM_HASH_ALGORITHM_SHA1=0,cadesplugin.CADESCOM_HASH_ALGORITHM_MD2=1,cadesplugin.CADESCOM_HASH_ALGORITHM_MD4=2,cadesplugin.CADESCOM_HASH_ALGORITHM_MD5=3,cadesplugin.CADESCOM_HASH_ALGORITHM_SHA_256=4,cadesplugin.CADESCOM_HASH_ALGORITHM_SHA_384=5,cadesplugin.CADESCOM_HASH_ALGORITHM_SHA_512=6,cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411=100,cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_256=101,cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_512=102,cadesplugin.LOG_LEVEL_DEBUG=4,cadesplugin.LOG_LEVEL_INFO=2,cadesplugin.LOG_LEVEL_ERROR=1}function async_spawn(e){function t(e,t){var r
try{r=n[e](t)}catch(e){return Promise.reject(e)}return r.done?r.value:Promise.resolve(r.value).then(i,o)}var n=e(Array.prototype.slice.call(arguments,1)),i=t.bind(t,"next"),o=t.bind(t,"throw")
return i()}function isIE(){var e="Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/Trident\/./i)
return e}function isIOS(){var e=navigator.userAgent.match(/ipod/i)||navigator.userAgent.match(/ipad/i)||navigator.userAgent.match(/iphone/i)
return e}function isChromiumBased(){var e=navigator.userAgent.match(/chrome/i)
navigator.userAgent.match(/chromeframe/i)
return isOpera=navigator.userAgent.match(/opr/i),isYaBrowser=navigator.userAgent.match(/YaBrowser/i),null!=e&&(e.length>0||null!=isOpera)}function CreateObject(e){if(isIOS())return call_ru_cryptopro_npcades_10_native_bridge("CreateObject",[e])
if(isIE()){if(e.match(/X509Enrollment/i))try{var t=document.getElementById("certEnrollClassFactory")
return t.CreateObject(e)}catch(e){throw"Для создания обьектов X509Enrollment следует настроить веб-узел на использование проверки подлинности по протоколу HTTPS"}try{var n=document.getElementById("webClassFactory")
return n.CreateObject(e)}catch(t){return new ActiveXObject(e)}}return pluginObject.CreateObject(e)}function CreateObjectAsync(e){return pluginObject.CreateObjectAsync(e)}function call_ru_cryptopro_npcades_10_native_bridge(functionName,array){var tmpobj,ex
if(ru_cryptopro_npcades_10_native_bridge.call(functionName,array,function(e,response){ex=e
var str="tmpobj="+response
eval(str),"string"==typeof tmpobj&&(tmpobj=tmpobj.replace(/\\\n/gm,"\n"),tmpobj=tmpobj.replace(/\\\r/gm,"\r"))}),ex)throw ex
return tmpobj}function install_opera_extension(){window.cadesplugin_skip_extension_install?plugin_loaded_error("Плагин недоступен"):document.addEventListener("DOMContentLoaded",function(){var e=document.createElement("div")
e.id="cadesplugin_ovr",e.style="visibility: hidden; position: fixed; left: 0px; top: 0px; width:100%; height:100%; background-color: rgba(0,0,0,0.7)",e.innerHTML="<div id='cadesplugin_ovr_item' style='position:relative; width:400px; margin:100px auto; background-color:#fff; border:2px solid #000; padding:10px; text-align:center; opacity: 1; z-index: 1500'><button id='cadesplugin_close_install' style='float: right; font-size: 10px; background: transparent; border: 1; margin: -5px'>X</button><p>Для работы КриптоПро ЭЦП Browser plugin на данном сайте необходимо установить расширение из каталога дополнений Opera.<p><button id='cadesplugin_install' style='font:12px Arial'>Установить расширение</button></p></div>",document.getElementsByTagName("Body")[0].appendChild(e)
var t=document.getElementById("cadesplugin_install")
t.addEventListener("click",function(e){opr.addons.installExtension("epebfcehmdedogndhlcacafjaacknbcm",function(){document.getElementById("cadesplugin_ovr").style.visibility="hidden",location.reload()},function(){})}),document.getElementById("cadesplugin_close_install").addEventListener("click",function(){plugin_loaded_error("Плагин недоступен"),document.getElementById("cadesplugin_ovr").style.visibility="hidden"}),e.addEventListener("click",function(){plugin_loaded_error("Плагин недоступен"),document.getElementById("cadesplugin_ovr").style.visibility="hidden"}),e.style.visibility="visible",document.getElementById("cadesplugin_ovr_item").addEventListener("click",function(e){e.stopPropagation()})})}function extension_onload(){window.postMessage("cadesplugin_echo_request","*"),window.addEventListener("message",function(e){"cadesplugin_loaded"==e.data&&cpcsp_chrome_nmcades.check_chrome_plugin(plugin_loaded,plugin_loaded_error)},!1)}function load_extension(){var e=document.createElement("script")
e.setAttribute("type","text/javascript"),e.setAttribute("src","chrome-extension://iifchhfnnmpdbibifmljnfjhpififfog/nmcades_plugin_api.js"),e.onerror=plugin_loaded_error,e.onload=extension_onload,document.getElementsByTagName("head")[0].appendChild(e),e=document.createElement("script"),e.setAttribute("type","text/javascript"),e.setAttribute("src","chrome-extension://epebfcehmdedogndhlcacafjaacknbcm/nmcades_plugin_api.js"),e.onerror=plugin_loaded_error,e.onload=extension_onload,document.getElementsByTagName("head")[0].appendChild(e)}function load_npapi_plugin(){var e=document.createElement("object")
if(e.setAttribute("id","cadesplugin_object"),e.setAttribute("type","application/x-cades"),e.setAttribute("style","visibility=hidden"),document.getElementsByTagName("body")[0].appendChild(e),pluginObject=document.getElementById("cadesplugin_object"),isIE()){var t=document.createElement("object")
t.setAttribute("id","certEnrollClassFactory"),t.setAttribute("classid","clsid:884e2049-217d-11da-b2a4-000e7bbb2b09"),t.setAttribute("style","visibility=hidden"),document.getElementsByTagName("body")[0].appendChild(t)
var n=document.createElement("object")
n.setAttribute("id","webClassFactory"),n.setAttribute("classid","clsid:B04C8637-10BD-484E-B0DA-B8A039F60024"),n.setAttribute("style","visibility=hidden"),document.getElementsByTagName("body")[0].appendChild(n)}}function plugin_loaded(){plugin_resolved=1,canPromise?plugin_resolve():window.postMessage("cadesplugin_loaded","*")}function plugin_loaded_error(e){if(isChromiumBased()){if(failed_extensions++,failed_extensions<2)return
if(isOpera&&("undefined"==typeof e||"object"==typeof e))return void install_opera_extension()}"undefined"!=typeof e&&"object"!=typeof e||(e="Плагин недоступен"),plugin_resolved=1,canPromise?plugin_reject(e):window.postMessage("cadesplugin_load_error","*")}function check_load_timeout(){1!=plugin_resolved&&(plugin_resolved=1,canPromise?plugin_reject("Истекло время ожидания загрузки плагина"):window.postMessage("cadesplugin_load_error","*"))}function createPromise(e){return new Promise(e)}function check_npapi_plugin(){try{CreateObject("CAdESCOM.About")
plugin_loaded()}catch(n){document.getElementById("cadesplugin_object").style.display="none"
var e=navigator.mimeTypes["application/x-cades"]
if(e){var t=e.enabledPlugin
plugin_loaded_error(t?"Плагин загружен, но не создаются обьекты":"Ошибка при загрузке плагина")}else plugin_loaded_error("Плагин недоступен")}}function check_plugin_working(){var e=document.createElement("div")
e.innerHTML="<!--[if lt IE 9]><iecheck></iecheck><![endif]-->"
var t=1==e.getElementsByTagName("iecheck").length
return t?void plugin_loaded_error("Internet Explorer версии 8 и ниже не поддерживается"):void(isChromiumBased()?load_extension():canPromise?window.addEventListener("load",function(e){load_npapi_plugin(),check_npapi_plugin()},!1):window.addEventListener("message",function(e){"cadesplugin_echo_request"==e.data&&(load_npapi_plugin(),check_npapi_plugin())},!1))}function set_pluginObject(e){pluginObject=e}if(!window.cadesplugin){var pluginObject,plugin_resolved=0,plugin_reject,plugin_resolve,isOpera=0,isYaBrowser=0,failed_extensions=0,canPromise=!!window.Promise,cadesplugin
cadesplugin=canPromise?new Promise(function(e,t){plugin_resolve=e,plugin_reject=t}):{}
var ru_cryptopro_npcades_10_native_bridge={callbacksCount:1,callbacks:{},resultForCallback:function(e,t){var n=ru_cryptopro_npcades_10_native_bridge.callbacks[e]
n&&n.apply(null,t)},call:function(e,t,n){var i=n&&"function"==typeof n,o=i?ru_cryptopro_npcades_10_native_bridge.callbacksCount++:0
i&&(ru_cryptopro_npcades_10_native_bridge.callbacks[o]=n)
var r=document.createElement("IFRAME"),s=new Array("_CPNP_handle")
try{r.setAttribute("src","cpnp-js-call:"+e+":"+o+":"+encodeURIComponent(JSON.stringify(t,s)))}catch(e){alert(e)}document.documentElement.appendChild(r),r.parentNode.removeChild(r),r=null}}
cadesplugin.JSModuleVersion="2.0.2",cadesplugin.async_spawn=async_spawn,cadesplugin.set=set_pluginObject,cadesplugin.set_log_level=set_log_level,isChromiumBased()&&(cadesplugin.CreateObjectAsync=CreateObjectAsync),isChromiumBased()||(cadesplugin.CreateObject=CreateObject),window.cadesplugin_load_timeout?setTimeout(check_load_timeout,window.cadesplugin_load_timeout):setTimeout(check_load_timeout,2e4),set_constantValues(),cadesplugin.current_log_level=cadesplugin.LOG_LEVEL_ERROR,window.cadesplugin=cadesplugin,check_plugin_working()}}(),PromiseHelper.prototype.all=function(e){var t=[]
for(var n in e)t.push(new Promise(function(t,i){var o=n
e[n].then(function(e){t({name:o,value:e})}).then(null,function(e){i(e)})}))
return new Promise(function(e,n){Promise.all(t).then(function(t){var n={}
for(var i in t)n[t[i].name]=t[i].value
e(n)}).then(null,function(e){n(e)})})},PromiseHelper.prototype.resolve=function(e){return e instanceof Promise||(e=Promise.resolve(e)),e},PromiseHelper.prototype.apply=function(e,t,n){try{var i=Cades.prototype.resolve(e.apply(t,n))}catch(e){i=Promise.reject(e)}return i},ToArrayHelper.prototype.toArray=function(e){return new Promise(function(t,n){var i={}
for(var o in this._toArrayMap)void 0!=e&&e[o]!==!0||(i[o]=this._toArrayMap[o].apply(this,[]))
PromiseHelper.prototype.all(i).then(function(e){t(e)}).then(null,function(e){n(e)})}.bind(this))},Cades.prototype.isIE=function(){return"Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/Trident\/./i)},Cades.prototype.isIOS=function(){return navigator.userAgent.match(/ipod/i)||navigator.userAgent.match(/ipad/i)||navigator.userAgent.match(/iphone/i)},Cades.prototype.isChromiumBased=function(){var e=navigator.userAgent.match(/chrome/i),t=navigator.userAgent.match(/opr/i)
return e.length>0||null!=t},Cades.prototype.OBJECT_STORE="CAPICOM.Store",Cades.prototype.OBJECT_CADES_SIGNED_DATA="CAdESCOM.CadesSignedData",Cades.prototype.OBJECT_CP_SIGNER="CAdESCOM.CPSigner",Cades.prototype.OBJECT_CP_ATTRIBUTE="CAdESCOM.CPAttribute",Cades.prototype.object=function(e){return new Promise(function(t,n){cadesplugin.then(function(){t(cadesplugin.CreateObjectAsync?cadesplugin.CreateObjectAsync(e):Promise.resolve(cadesplugin.CreateObject(e)))}).then(null,function(e){n(e)})})},Cades.prototype.resolve=PromiseHelper.prototype.resolve,Cades.prototype.apply=PromiseHelper.prototype.apply,Store.prototype.open=function(){return PromiseHelper.prototype.apply(function(e,t,n){return arguments.length?1==arguments.length?this._store.Open(e):2==arguments.length?this._store.Open(e,t):arguments.length>=3?this._store.Open(e,t,n):void 0:this._store.Open()}.bind(this),this._store,arguments)},Store.prototype.close=function(){return PromiseHelper.prototype.apply(function(){return this._store.Close()}.bind(this),this._store,arguments)},Store.prototype.getName=function(){return PromiseHelper.prototype.resolve(this._store.Name)},Store.prototype.getLocation=function(){return PromiseHelper.prototype.resolve(this._store.Location)},Store.prototype._toArrayMap={name:Store.prototype.getName,location:Store.prototype.getLocation,certificates:function(e){return new Promise(function(e,t){this.getCertificates().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))}},Store.prototype.toArray=ToArrayHelper.prototype.toArray,Cades.prototype.store=function(){return new Promise(function(e,t){Cades.prototype.object(Cades.prototype.OBJECT_STORE).then(function(t){e(new Store(t))}).then(null,function(e){t(e)})})},SignedData.prototype.getObject=function(){return this._signedData},SignedData.prototype.setContentEncoding=function(e){return Cades.prototype.isChromiumBased()?this._signedData.propset_ContentEncoding(e):Cades.prototype.isIE()&&(this._signedData.ContentEncoding=e),this},SignedData.prototype.setContent=function(e){return Cades.prototype.isChromiumBased()?this._signedData.propset_Content(e):this._signedData.Content=e,this},SignedData.prototype.signCades=function(){return this._signedData.SignCades.apply(this._signedData,arguments)},Cades.prototype.signedData=function(){return new Promise(function(e,t){Cades.prototype.object(Cades.prototype.OBJECT_CADES_SIGNED_DATA).then(function(t){e(new SignedData(t))}).then(null,function(e){t(e)})})},Signer.prototype.getObject=function(){return this._signer},Signer.prototype.setCertificate=function(e){return Cades.prototype.isChromiumBased()?this._signer.propset_Certificate(e):this._signer.Certificate=e,this},Signer.prototype.getAuthenticatedAttributes=function(){return void 0!=this._signer.AuthenticatedAttributes2?Cades.prototype.resolve(this._signer.AuthenticatedAttributes2):Cades.prototype.resolve(this._signer.AuthenticatedAttributes)},Cades.prototype.signer=function(){return new Promise(function(e,t){Cades.prototype.object(Cades.prototype.OBJECT_CP_SIGNER).then(function(t){e(new Signer(t))}).then(null,function(e){t(e)})})},CPAttribute.prototype.getObject=function(){return this._attribute},CPAttribute.prototype.setName=function(e){return Cades.prototype.isChromiumBased()?this._attribute.propset_Name(e):this._attribute.Name=e,this},CPAttribute.prototype.setValue=function(e){return Cades.prototype.isChromiumBased()?this._attribute.propset_Value(e):this._attribute.Value=e,this},Cades.prototype.CPAttribute=function(){return new Promise(function(e,t){Cades.prototype.object(Cades.prototype.OBJECT_CP_ATTRIBUTE).then(function(t){e(new CPAttribute(t))}).then(null,function(e){t(e)})})},Certificates.prototype.find=function(){var e=arguments
return new Promise(function(t,n){Cades.prototype.apply(function(t,n,i){return e.length?1==e.length?this._certificates.Find(t):2==e.length?this._certificates.Find(t,n):e.length>=3?this._certificates.Find(t,n,i):void 0:this._certificates}.bind(this),this._certificates,e).then(function(e){t(new Certificates(e))}).then(null,function(e){n(e)})}.bind(this))},Certificates.prototype.getItem=function(e){return Cades.prototype.apply(function(e){return this._certificates.Item(e)}.bind(this),this._certificates,arguments)},Certificates.prototype.getCount=function(){return Cades.prototype.resolve(this._certificates.Count)},Certificates.prototype.toArray=function(e){return new Promise(function(e,t){this.getCount().then(function(t){for(var n=[],i=1;i<=t;i++)n.push(new Promise(function(e,t){this.getItem(i).then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this)))
e(Promise.all(n))}.bind(this)).then(null,function(e){t(e)})}.bind(this))},Store.prototype.getCertificates=function(){return new Promise(function(e,t){Cades.prototype.resolve(this._store.Certificates).then(function(t){e(new Certificates(t))}).then(null,function(e){t(e)})}.bind(this))},Certificate.prototype.exportTo=function(){return Cades.prototype.apply(function(e){return arguments.length||(e=this.CAPICOM_ENCODE_BASE64),this._certificate.Export(e)}.bind(this),this._certificate,arguments)},Certificate.prototype.getObject=function(){return Cades.prototype.resolve(this._certificate)},Certificate.prototype.importFrom=function(){return Cades.prototype.apply(function(e){return this._certificate.Import(e)}.bind(this),this._certificate,arguments)},Certificate.prototype.getInfo=function(){return Cades.prototype.apply(function(e){return this._certificate.GetInfo(e)}.bind(this),this._certificate,arguments)},Certificate.prototype.hasPrivateKey=function(){return Cades.prototype.apply(function(){return this._certificate.HasPrivateKey()}.bind(this),this._certificate,arguments)},Certificate.prototype.isValid=function(){return Cades.prototype.apply(function(){return this._certificate.IsValid()}.bind(this),this._certificate,arguments)},Certificate.prototype.getIssuerName=function(){return Cades.prototype.resolve(this._certificate.IssuerName)},Certificate.prototype.getSerialNumber=function(){return Cades.prototype.resolve(this._certificate.SerialNumber)},Certificate.prototype.getSubjectName=function(){return Cades.prototype.resolve(this._certificate.SubjectName)},Certificate.prototype.getThumbprint=function(){return Cades.prototype.resolve(this._certificate.Thumbprint)},Certificate.prototype.getValidFromDate=function(){return Cades.prototype.resolve(this._certificate.ValidFromDate)},Certificate.prototype.getValidToDate=function(){return Cades.prototype.resolve(this._certificate.ValidToDate)},Certificate.prototype.getVersion=function(){return Cades.prototype.resolve(this._certificate.Version)},Certificate.prototype.getExtendedKeyUsage=function(){return Cades.prototype.apply(function(){return this._certificate.ExtendedKeyUsage()}.bind(this),this._certificate,arguments)},Certificate.prototype.getKeyUsage=function(){return Cades.prototype.apply(function(){return this._certificate.KeyUsage()}.bind(this),this._certificate,arguments)},Certificate.prototype.getPublicKey=function(){return Cades.prototype.apply(function(){return this._certificate.PublicKey()}.bind(this),this._certificate,arguments)},Certificate.prototype.getPrivateKey=function(){return Cades.prototype.resolve(this._certificate.PrivateKey)},Certificate.prototype.getBasicConstraints=function(){return Cades.prototype.apply(function(){return this._certificate.BasicConstraints()}.bind(this),this._certificate,arguments)},Certificate.prototype._toArrayMap={hasPrivateKey:Certificate.prototype.hasPrivateKey,isValid:function(e){return new Promise(function(e,t){this.isValid().then(function(n){n.getResult().then(function(t){e(t)}).then(null,function(e){t(e)})}).then(null,function(e){t(e)})}.bind(this))},issuerName:Certificate.prototype.getIssuerName,serialNumber:Certificate.prototype.getSerialNumber,subjectName:Certificate.prototype.getSubjectName,thumbprint:Certificate.prototype.getThumbprint,validFromDate:Certificate.prototype.getValidFromDate,validToDate:Certificate.prototype.getValidToDate,version:Certificate.prototype.getVersion,extendedKeyUsage:function(e){return new Promise(function(e,t){this.getExtendedKeyUsage().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))},keyUsage:function(e){return new Promise(function(e,t){this.getKeyUsage().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))},basicConstraints:function(e){return new Promise(function(e,t){this.getBasicConstraints().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))},publicKey:function(e){return new Promise(function(e,t){this.getPublicKey().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))},privateKey:function(e){return new Promise(function(e,t){this.getPrivateKey().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))}},Certificate.prototype.toArray=ToArrayHelper.prototype.toArray,Certificates.prototype.getItem=function(e){return new Promise(function(t,n){Cades.prototype.apply(function(e){return this._certificates.Item(e)}.bind(this),this._certificates,[e]).then(function(e){t(new Certificate(e))}).then(null,function(e){n(e)})}.bind(this))},CertificateStatus.prototype.getResult=function(){return Cades.prototype.resolve(this._certificateStatus.Result)},Certificate.prototype.isValid=function(){return new Promise(function(e,t){Cades.prototype.apply(function(){return this._certificate.IsValid()}.bind(this),this._certificate,arguments).then(function(t){e(new CertificateStatus(t))}).then(null,function(e){t(e)})}.bind(this))},ExtendedKeyUsage.prototype.getEKUs=function(){return Cades.prototype.resolve(this._extendedKeyUsage.EKUs)},ExtendedKeyUsage.prototype.isCritical=function(){return Cades.prototype.resolve(this._extendedKeyUsage.IsCritical)},ExtendedKeyUsage.prototype.isPresent=function(){return Cades.prototype.resolve(this._extendedKeyUsage.IsPresent)},ExtendedKeyUsage.prototype._toArrayMap={ekus:function(e){return new Promise(function(e,t){this.getEKUs().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))},isCritical:ExtendedKeyUsage.prototype.isCritical,isPresent:ExtendedKeyUsage.prototype.isPresent},ExtendedKeyUsage.prototype.toArray=ToArrayHelper.prototype.toArray,Certificate.prototype.getExtendedKeyUsage=function(){return new Promise(function(e,t){Cades.prototype.apply(function(){return this._certificate.ExtendedKeyUsage()}.bind(this),this._certificate,arguments).then(function(t){e(new ExtendedKeyUsage(t))}).then(null,function(e){t(e)})}.bind(this))},EKUs.prototype.getItem=function(e){return Cades.prototype.apply(function(e){return this._ekus.Item(e)}.bind(this),this._ekus,[e])},EKUs.prototype.getCount=function(){return Cades.prototype.resolve(this._ekus.Count)},EKUs.prototype.toArray=function(e){return new Promise(function(e,t){this.getCount().then(function(t){for(var n=[],i=1;i<=t;i++)n.push(new Promise(function(e,t){this.getItem(i).then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this)))
e(Promise.all(n))}.bind(this)).then(null,function(e){t(e)})}.bind(this))},ExtendedKeyUsage.prototype.getEKUs=function(){return new Promise(function(e,t){Cades.prototype.resolve(this._extendedKeyUsage.EKUs).then(function(t){e(new EKUs(t))}).then(null,function(e){t(e)})}.bind(this))},EKU.prototype.getName=function(){return Cades.prototype.resolve(this._eku.Name)},EKU.prototype.getOID=function(){return Cades.prototype.resolve(this._eku.OID)},EKU.prototype._toArrayMap={name:EKU.prototype.getName,oid:EKU.prototype.getOID},EKU.prototype.toArray=ToArrayHelper.prototype.toArray,EKUs.prototype.getItem=function(e){return new Promise(function(t,n){Cades.prototype.apply(function(e){return this._ekus.Item(e)}.bind(this),this._ekus,[e]).then(function(e){t(new EKU(e))}).then(null,function(e){n(e)})}.bind(this))},KeyUsage.prototype.isCritical=function(){return Cades.prototype.resolve(this._keyUsage.IsCritical)},KeyUsage.prototype.isCRLSignEnabled=function(){return Cades.prototype.resolve(this._keyUsage.IsCRLSignEnabled)},KeyUsage.prototype.isDataEnciphermentEnabled=function(){return Cades.prototype.resolve(this._keyUsage.IsDataEnciphermentEnabled)},KeyUsage.prototype.isDecipherOnlyEnabled=function(){return Cades.prototype.resolve(this._keyUsage.IsDecipherOnlyEnabled)},KeyUsage.prototype.isDigitalSignatureEnabled=function(){return Cades.prototype.resolve(this._keyUsage.IsDigitalSignatureEnabled)},KeyUsage.prototype.isEncipherOnlyEnabled=function(){return Cades.prototype.resolve(this._keyUsage.IsEncipherOnlyEnabled)},KeyUsage.prototype.isKeyAgreementEnabled=function(){return Cades.prototype.resolve(this._keyUsage.IsKeyAgreementEnabled)},KeyUsage.prototype.isKeyCertSignEnabled=function(){return Cades.prototype.resolve(this._keyUsage.IsKeyCertSignEnabled)},KeyUsage.prototype.isKeyEnciphermentEnabled=function(){return Cades.prototype.resolve(this._keyUsage.IsKeyEnciphermentEnabled)},KeyUsage.prototype.isNonRepudiationEnabled=function(){return Cades.prototype.resolve(this._keyUsage.IsNonRepudiationEnabled)},KeyUsage.prototype.isPresent=function(){return Cades.prototype.resolve(this._keyUsage.IsPresent)},KeyUsage.prototype._toArrayMap={isCritical:KeyUsage.prototype.isCritical,isCrlSignEnabled:KeyUsage.prototype.isCRLSignEnabled,isDataEnciphermentEnabled:KeyUsage.prototype.isDataEnciphermentEnabled,isDecipherOnlyEnabled:KeyUsage.prototype.isDecipherOnlyEnabled,isDigitalSignatureEnabled:KeyUsage.prototype.isDigitalSignatureEnabled,isEncipherOnlyEnabled:KeyUsage.prototype.isEncipherOnlyEnabled,isKeyAgreementEnabled:KeyUsage.prototype.isKeyAgreementEnabled,isKeyCertSignEnabled:KeyUsage.prototype.isKeyCertSignEnabled,isKeyEnciphermentEnabled:KeyUsage.prototype.isKeyEnciphermentEnabled,isNonRepudiationEnabled:KeyUsage.prototype.isNonRepudiationEnabled,isPresent:KeyUsage.prototype.isPresent},KeyUsage.prototype.toArray=ToArrayHelper.prototype.toArray,Certificate.prototype.getKeyUsage=function(){return new Promise(function(e,t){Cades.prototype.apply(function(){return this._certificate.KeyUsage()}.bind(this),this._certificate,arguments).then(function(t){e(new KeyUsage(t))}).then(null,function(e){t(e)})}.bind(this))},PublicKey.prototype.getAlgorithm=function(){return Cades.prototype.resolve(this._publicKey.Algorithm)},PublicKey.prototype.getEncodedKey=function(){return Cades.prototype.resolve(this._publicKey.EncodedKey)},PublicKey.prototype.getEncodedParameters=function(){return Cades.prototype.resolve(this._publicKey.EncodedParameters)},PublicKey.prototype.getLength=function(){return Cades.prototype.resolve(this._publicKey.Length)},PublicKey.prototype._toArrayMap={algorithm:PublicKey.prototype.getAlgorithm,encodedKey:PublicKey.prototype.getEncodedKey,encodedParameters:PublicKey.prototype.getEncodedParameters,length:PublicKey.prototype.getLength},PublicKey.prototype.toArray=ToArrayHelper.prototype.toArray,Certificate.prototype.getPublicKey=function(){return new Promise(function(e,t){Cades.prototype.apply(function(){return this._certificate.PublicKey()}.bind(this),this._certificate,arguments).then(function(t){e(new PublicKey(t))}).then(null,function(e){t(e)})}.bind(this))},OID.prototype.getFriendlyName=function(){return Cades.prototype.resolve(this._oid.FriendlyName)},OID.prototype.getName=function(){return Cades.prototype.resolve(this._oid.Name)},OID.prototype.getValue=function(){return Cades.prototype.resolve(this._oid.Value)},OID.prototype._toArrayMap={friendlyName:OID.prototype.getFriendlyName,name:OID.prototype.getName,value:OID.prototype.getValue},OID.prototype.toArray=ToArrayHelper.prototype.toArray,PublicKey.prototype.getAlgorithm=function(){return new Promise(function(e,t){Cades.prototype.resolve(this._publicKey.Algorithm).then(function(t){e(new OID(t))}).then(null,function(e){t(e)})}.bind(this))},PublicKey.prototype._toArrayMap.algorithm=function(e){return new Promise(function(e,t){this.getAlgorithm().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))},EncodedData.prototype.getValue=function(){var e=this._encodedData.Value
return"function"==typeof this._encodedData.Value&&(e=this._encodedData.Value()),Cades.prototype.resolve(e)},EncodedData.prototype._toArrayMap={value:EncodedData.prototype.getValue},EncodedData.prototype.toArray=ToArrayHelper.prototype.toArray,PublicKey.prototype.getEncodedKey=function(){return new Promise(function(e,t){Cades.prototype.resolve(this._publicKey.EncodedKey).then(function(t){e(new EncodedData(t))}).then(null,function(e){t(e)})}.bind(this))},PublicKey.prototype._toArrayMap.encodedKey=function(e){return new Promise(function(e,t){this.getEncodedKey().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))},PublicKey.prototype.getEncodedParameters=function(){return new Promise(function(e,t){Cades.prototype.resolve(this._publicKey.EncodedParameters).then(function(t){e(new EncodedData(t))}).then(null,function(e){t(e)})}.bind(this))},PublicKey.prototype._toArrayMap.encodedParameters=function(e){return new Promise(function(e,t){this.getEncodedParameters().then(function(t){e(t.toArray())}).then(null,function(e){t(e)})}.bind(this))},PrivateKey.prototype.getContainerName=function(){return Cades.prototype.resolve(this._privateKey.ContainerName)},PrivateKey.prototype.getKeySpec=function(){return Cades.prototype.resolve(this._privateKey.KeySpec)},PrivateKey.prototype.getProviderName=function(){return Cades.prototype.resolve(this._privateKey.ProviderName)},PrivateKey.prototype.getProviderType=function(){return Cades.prototype.resolve(this._privateKey.ProviderType)},PrivateKey.prototype.getUniqueContainerName=function(){return Cades.prototype.resolve(this._privateKey.UniqueContainerName)},PrivateKey.prototype._toArrayMap={containerName:PrivateKey.prototype.getContainerName,keySpec:PrivateKey.prototype.getKeySpec,providerName:PrivateKey.prototype.getProviderName,providerType:PrivateKey.prototype.getProviderType,uniqueContainerName:PrivateKey.prototype.getUniqueContainerName},PrivateKey.prototype.toArray=ToArrayHelper.prototype.toArray,Certificate.prototype.getPrivateKey=function(){return new Promise(function(e,t){Cades.prototype.resolve(this._certificate.PrivateKey).then(function(t){e(new PrivateKey(t))}).then(null,function(e){t(e)})}.bind(this))},BasicConstraints.prototype.isCertificateAuthority=function(){return Cades.prototype.resolve(this._basicConstraints.IsCertificateAuthority)},BasicConstraints.prototype.isCritical=function(){return Cades.prototype.resolve(this._basicConstraints.IsCritical)},BasicConstraints.prototype.isPathLenConstraintPresent=function(){return Cades.prototype.resolve(this._basicConstraints.IsPathLenConstraintPresent)},BasicConstraints.prototype.isPresent=function(){return Cades.prototype.resolve(this._basicConstraints.IsPresent)},BasicConstraints.prototype.getPathLenConstraint=function(){return Cades.prototype.resolve(this._basicConstraints.PathLenConstraint)},BasicConstraints.prototype._toArrayMap={isCertificateAuthority:BasicConstraints.prototype.isCertificateAuthority,isCritical:BasicConstraints.prototype.isCritical,isPathLenConstraintPresent:BasicConstraints.prototype.isPathLenConstraintPresent,isPresent:BasicConstraints.prototype.isPresent,pathLenConstraint:BasicConstraints.prototype.getPathLenConstraint},BasicConstraints.prototype.toArray=ToArrayHelper.prototype.toArray,Certificate.prototype.getBasicConstraints=function(){return new Promise(function(e,t){Cades.prototype.apply(function(){return this._certificate.BasicConstraints()}.bind(this),this._certificate,arguments).then(function(t){e(new BasicConstraints(t))}).then(null,function(e){t(e)})}.bind(this))},function(){window.cades||(Cades.prototype.pStore=null,Cades.prototype.pStoreIsOpen=!1,Cades.prototype.pCetrificates=null,Cades.prototype.openStore=function(e){return this.pStoreIsOpen?this:(e=e||[],this.pStore=cades.then(function(){return this.store()}.bind(this)).then(function(t){return t.open.apply(t,e).then(function(){return this.pStoreIsOpen=!0,t}.bind(this),function(e){throw e})}.bind(this),function(e){throw e}),this)},Cades.prototype.closeStore=function(){return this.pStore instanceof Promise?(this.pStore.then(function(e){e.close().then(function(){this.pStoreIsOpen=!1,this.pStore=null}.bind(this),function(e){})}.bind(this)),this):this},Cades.prototype.findCertificates=function(e){if(!(this.pStore instanceof Promise))throw new Error("Store is closed")
return e=e||[],this.pStore.then(function(t){return t.getCertificates().then(function(t){return t.find.apply(t,e)}.bind(this))}.bind(this))},Cades.prototype.findCertificate=function(e){return this.pStore instanceof Promise?(e=e||[],this.pStore.then(function(e){return e.getCertificates()}.bind(this)).then(function(t){return t.find.apply(t,e)}.bind(this)).then(function(e){return e.getCount().then(function(t){return 0==t?Promise.resolve(null):e.getItem(1)}.bind(this))}.bind(this))):Promise.resolve(null)},Cades.prototype.getCertificatesInfo=function(e){return this.pCetrificates instanceof Promise?this.pCetrificates:this.findCertificates(e).then(function(e){return new Promise(function(t){t(Promise.all([e,e.getCount()]))}.bind(this),function(e){throw e})}.bind(this)).then(function(e){var t=e.shift(),n=e.shift()
return new Promise(function(e,i){for(var o=[],r=1;r<=n;r++){var s=t.getItem(r).then(function(e){return{SerialNumber:e.getSerialNumber(),IssuerName:e.getIssuerName(),SubjectName:e.getSubjectName(),Thumbprint:e.getThumbprint(),ValidFromDate:e.getValidFromDate(),ValidToDate:e.getValidToDate(),Version:e.getVersion(),UserName:e.getInfo(e.CAPICOM_CERT_INFO_SUBJECT_SIMPLE_NAME),UserEmail:e.getInfo(e.CAPICOM_CERT_INFO_SUBJECT_EMAIL_NAME),certificateName:e.getInfo(e.CAPICOM_CERT_INFO_ISSUER_SIMPLE_NAME),certificateEmail:e.getInfo(e.CAPICOM_CERT_INFO_ISSUER_EMAIL_NAME),SubjectUPN:e.getInfo(e.CAPICOM_CERT_INFO_SUBJECT_UPN),IssuerUPN:e.getInfo(e.CAPICOM_CERT_INFO_ISSUER_UPN),SubjectDNSName:e.getInfo(e.CAPICOM_CERT_INFO_SUBJECT_DNS_NAME),IssuerDNSName:e.getInfo(e.CAPICOM_CERT_INFO_ISSUER_DNS_NAME)}}).then(function(e){return PromiseHelper.prototype.all(e)},function(e){i(e)})
o.push(s)}e(Promise.all(o))}.bind(this))}.bind(this)).then(function(e){return this.pCetrificates=e,e}.bind(this))},Cades.prototype.signMessage=function(e,t,n,i){return n=n||null,i=i||!0,cades.then(function(){var i=this.signedData().then(function(e){return e.setContentEncoding(e.CADESCOM_STRING_TO_UCS2LE),e.setContent(t),e}.bind(this)),o=this.signer().then(function(e){return this.CPAttribute().then(function(t){return n?(t.setName(t.CAPICOM_AUTHENTICATED_ATTRIBUTE_SIGNING_TIME),t.setValue(n),e.getAuthenticatedAttributes().then(function(n){return n.Add(t.getObject()),e}.bind(this))):e}.bind(this))}.bind(this))
return new Promise(function(t){t(Promise.all([i,o,e.getObject()]))}.bind(this),function(e){throw e})}.bind(this)).then(function(e){var t=e.shift(),n=e.shift(),o=e.shift()
return n.setCertificate(o),t.signCades(n.getObject(),t.CADESCOM_CADES_BES,i,t.CAPICOM_ENCODE_BASE64)}.bind(this))},window.cades=new Cades,window.cades.CAPICOM_MY_STORE="My",window.cades.CAPICOM_CURRENT_USER_STORE=2,window.cades.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED=2,window.cades.CAPICOM_STORE_OPEN_READ_ONLY=0,window.cades.CAPICOM_CERTIFICATE_FIND_TIME_VALID=9,window.cades.CAPICOM_CERTIFICATE_FIND_SHA1_HASH=0,window.cades.CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME=1)}()
